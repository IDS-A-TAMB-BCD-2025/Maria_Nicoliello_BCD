USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_COMSUMIDOR;

INSERT INTO SUPERMERCADO(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("12345678910","Supermercado Grick", "19123456","grick@gmail.com","Grick Street","10000","TambaCity","SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("98765432100", "Supermercado BomPreço", "191245321", "bompreco@gmail.com", "Avenida Central", "150", "Ribeirão Preto", "SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("11223344556", "Supermercado VerdeVida", "19123497", "verdevida@gmail.com", "Rua das Palmeiras", "200", "Campinas", "SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("22334455667", "Supermercado Econômico", "19123445", "economico@gmail.com", "Rua do Comércio", "350", "Piracicaba", "SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("33445566778", "Supermercado PagueMenos", "19123455", "paguemenos@gmail.com", "Avenida Brasil", "420", "Limeira", "SP");

INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("123456789", "Arroz 5kg", "5.0", "500", "26.30", "2025-12-25");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("987654321", "Feijão Carioca 1kg", "1.0", "300", "8.90", "2026-03-10");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("112233445", "Açúcar Refinado 1kg", "1.0", "400", "5.50", "2026-01-15");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("223344556", "Café Torrado e Moído 500g", "0.5", "250", "12.75", "2025-11-30");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("334455667", "Óleo de Soja 900ml", "0.9", "350", "7.20", "2026-02-20");

INSERT INTO CONSUMIDOR(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("48021128888", "Maria Eduarda", "19992067406", "mariaeduarda@gmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("32569874100", "João Pedro", "19987541236", "joaopedro@gmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("21478596311", "Ana Clara", "19996587412", "anaclara@gmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("65897412322", "Lucas Henrique", "19995876345", "lucashenrique@gmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES ("78965412333", "Fernanda Silva", "19991234567", "fernandasilva@gmail.com");

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("79024425541","José", "1985-12-12", "19998064555", "josé@gmail.com", "carteira.ze.pdf", "4567", "9876", "2020-01-15", "44 horas", "12345678910");

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("85236974100", "Mariana Souza", "1990-07-22", "19997456321", "marianasouza@gmail.com", "carteira.mari.pdf", "1234", "5678", "2021-03-10", "40 horas", "98765432100");

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("96325874111", "Carlos Alberto", "1988-05-18", "19998564123", "carlosalberto@gmail.com", "carteira.carlos.pdf", "7890", "1234", "2019-09-05", "44 horas", "11223344556");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("74185296322", "Beatriz Lima", "1995-11-02", "19997654321", "beatrizlima@gmail.com", "carteira.bea.pdf", "6543", "2109", "2022-07-20", "36 horas", "22334455667");

INSERT INTO FUNCIONARIO(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES ("35715948633", "Rafael Oliveira", "1992-09-14", "19998887766", "rafaeloliveira@gmail.com", "carteira.rafa.pdf", "9876", "5432", "2018-04-12", "44 horas", "33445566778");

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("12345678910", 1);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("98765432100", 2);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("11223344556", 3);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("22334455667", 4);

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES ("33445566778", 5);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("48021128888", 1);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("32569874100", 2);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("21478596311", 3);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("65897412322", 4);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES ("78965412333", 5);

SELECT * FROM SUPERMERCADO;

/* CONSULTAR O AUMENTO DE R$2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$5,00*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", (PRO_PRECO + 2) AS "PREÇO COM AJUSTE DE 2,00"
FROM PRODUTO
WHERE PRO_PRECO >= 5;

/* CONSULTAR A REDUÇÃO DE R$1,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL ABAIXO DE R$5,00*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", TRUNCATE((PRO_PRECO -1),2) AS "PREÇO COM REDUÇÃO DE R$1,00"
FROM PRODUTO
WHERE PRO_PRECO <= 10;

/* CONSULTAR COMO SERIA APLICAR DESCONTO DE 10% EM TODOS OS PRODUTPS*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇP ATUAL", (PRO_PRECO - (PRO_PRECO*0.1)) AS "PREÇO COM DESCONTO DE 10%"
FROM PRODUTO;

/* AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDIDO PELA METADE*/

SELECT PRO_ID, PRO_NOME, PRO_CODIGO_BARRAS, PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO 
SET PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID = 1;

/* CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM PRODUTO
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';
/* BETWEEN = ENTRE, USADO PARA DATAS */

/* CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$ 10 OU MENOR QUE R$ 4 */

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO" 
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;

/* CONSULATAR OS DDDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE */
SELECT				CON_NOME AS "NOME DO CONSUMIDOR",
					CON_CPF AS "CPF DO CONSUMIDOR",
SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TEFEFONE", 
SUBSTRING(CON_TELEFONE,3,9) AS "NÚMERO DO TELEFONE"
FROM CONSUMIDOR;

/* GERAR UMA FRASE CONCATENANDO: RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT CONCAT("RAZÃO SOCIAL: ",
				CONCAT(SUP_RAZAO_SOCIAL,
                CONCAT("| CNPJ:",
                CONCAT(SUP_CNPJ,
                CONCAT("| TELEFONE: ",
                CONCAT(SUP_TELEFONE,
                CONCAT("| EMAIL: ", (SUP_EMAIL)))))))) AS FRASE
FROM SUPERMERCADO;

/* GERAR UMA CONSULTA QUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS 
REGRAS: 1) QUANTIDADE <= 25: ESTOQUE BAIXO
		2) QUANTIDADE > 25 E QUANTIDADE <= 100: ESTOQUE MÉDIO
		3) QUANTIDADE > 100: ESTOQUE ALTO */
SELECT 		PRO_NOME 			AS "NOME DO PRODUTO", 
			PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS",	
			PRO_QUANTIDADE 		AS "QUANTIDADE",
			CASE 
				WHEN PRO_QUANTIDADE <= 25 THEN "ESTOQUE BAIXO"
				WHEN PRO_QUANTIDADE > 25 AND PRO_QUANTIDADE < 100 THEN "ESTOQUE MÉDIO"
				WHEN PRO_QUANTIDADE > 100 THEN "ESTOQUE ALTO"
			END AS "NÍVEL DE ESTOQUE"
FROM PRODUTO;

/* GERAR UMA CONSULTA QUE VERIFICA O PESO DOS PRODUTOS 
REGRAS: 1) PESO <= 5: PESO BAIXO
		2) PESO > 5 E QUANTIDADE <= 50: PESO MÉDIO
		3) PESO > 50: PESO ALTO */
SELECT 	PRO_NOME 		AS "NOME DO PRODUTO", 
	PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS", 
	PRO_QUANTIDADE 		AS "QUANTIDADE", 
	PRO_PESO 			AS "PESO",
	PRO_DATA_VALIDADE 	AS "DATA DE VALIDADE",
	CASE 
		WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
		WHEN PRO_PESO > 5 AND PRO_QUANTIDADE < 50 THEN "PESO MÉDIO"
		WHEN PRO_PESO > 50 THEN "PESO ALTO"
	END AS "NÍVEL DE PESO"
FROM PRODUTO;

/* CONTAR QUANTOS CONSUMIDOR TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM CONSUMIDOR;

/* CONTAR QUANTOS FUNCIONARIOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM FUNCIONARIO;

/* CONTAR QUANTOS PRODUTOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM PRODUTO;

/* SOMAR O PREÇO TOATL DE TODOS OS PRODUTOS CADASTRADO */
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

/* CALCULAR A MÉDIA DE PREÇOS DOS PRODUTOS */
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ",TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/* SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/* SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/* SELECIONAR O PRODUTO MAIS BARATO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/* SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/* SELECIONAR A DATA E HORA ATUAL*/
SELECT NOW() FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO",
	DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO",
    TIMESTAMPDIFF(YEAR, FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO;

/* FUNÇÕES MATEMÁTICA 
ABS - VALOR ABSOLUTO DE UM NÚMERO
ROUND - ARREDONDAR
POWER- POTÊNCIA*/
SELECT 	ABS(-10),
		ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
        POWER(PRO_PRECO,2) AS "PREÇO ELEVADO AO QUADRADO"
FROM PRODUTO;

/* UPPER, LOWER, TRIM */
SELECT 	UPPER(FUN_NOME) AS "MAIÚSCULAS",
		LOWER(FUN_NOME) AS "MINÚSCULO",
        TRIM("          Maria Eduarda") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;

SELECT PRO_QUANTIDADE,
COUNT(*) AS "REPETIÇÕES"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE;

/*UNION*/
SELECT FUN_NOME, FUN_CPF
FROM FUNCIONARIO
UNION 
SELECT FUN_NOME, FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/
SELECT PRO_NOME
FROM PRODUTO
UNION
SELECT "Arroz 5kg"
FROM DUAL
UNION 
SELECT "Iorgute do Bob Esponja"
FROM DUAL;

/*UNION ALL*/
SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "Arroz 5kg"
FROM DUAL
UNION ALL
SELECT "Iorgute do Bob Esponja"
FROM DUAL;

/*SELECT COM WHERE*/
SELECT 	FUN_NOME AS "NOME DO FUNCIONARIO",
		FUN_CPF AS "CPF DO FUNCIONÁRIO",
		FUN_DATA_NASCIMENTO AS "DATA DE NASCIMENTO",
TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) >= 25
AND TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) <=35;

/*RETORNAR OS FUNCIONÁRIOS, CONSUMIDORES E SUPERMERCADOS COM EMAIL IGUAL A HOTMAIL OU OUTLOOK*/
SELECT 	CON_NOME AS "NOME",
		CON_CPF AS "CPF/CNPJ",
		CON_TELEFONE AS "TELEFONE",
		CON_EMAIL AS "EMAIL",
		"CONSUMIDOR" AS "TIPO"
FROM CONSUMIDOR
WHERE 	UPPER(CON_EMAIL) LIKE "%EMAIL%"
OR 		UPPER(CON_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT 	FUN_NOME AS "NOME", 
		FUN_CPF AS "CPF/CNPJ",
		FUN_TELEFONE AS "TELEFONE",
		FUN_EMAIL AS "EMAIL",
		"FUNCIONÁRIOS" AS "TIPO"
FROM FUNCIONARIO 
WHERE 	UPPER(FUN_EMAIL) LIKE "%EMAIL%"
OR 		UPPER(FUN_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT 	SUP_RAZAO_SOCIAL AS "NOME",
		SUP_CNPJ AS "CPF/CNPJ",
		SUP_TELEFONE AS "TELEFONE",
		SUP_EMAIL AS "EMAIL",
		"SUPERMERCADO" AS "TIPO"
FROM SUPERMERCADO
WHERE 	UPPER(SUP_EMAIL) LIKE "%EMAIL%"
OR 		UPPER(SUP_EMAIL) LIKE "%OUTLOOK%";

/*CROSS JOIN: 
PEGAR TODOS OS PRODUTOS E OS SUPERMERCADDOS EM QUE SÃO VENDIDOS*/
SELECT 	PRODUTO.PRO_NOME AS "NOME",
		PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGOS DE BARRAS",
		SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM SUPERMERCADO_PRODUTO 
CROSS JOIN SUPERMERCADO 
CROSS JOIN PRODUTO 
WHERE PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

/*INNER JOIN:
RETORNA APENAS OS PRODUTOS QUE FOI COMPRADO APENAS POR ALGUM CONSUMIDOR*/
SELECT 	PRODUTO_CONSUMIDOR.PCO_ID AS "ID DA COMPRA",
		PRODUTO.PRO_NOME AS "NOME",
		PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
		CONSUMIDOR.CON_CPF AS "CPF DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO COM INNER JOIN:
RETORNAR APENAS OS FUNCIONÁRIOS QUE TRABALHA EM UM SUPERMERCADO
RETORNAR O NOME DO FUNCIONÁRIO E O NOME SUPERMERCADO QUE ELE TRABALHA*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
		FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONARIO"
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/* EXERCÍCIO 2 COM INNER JOIN:
RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMERCADO
RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMERCADO QUE ELE ESTÁ DISPONÍVEL*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
		PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ )
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*LEFT JOIN*/
INSERT INTO PRODUTO(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUE (33333333, "KITKAT", "30", "1500", 4.50, "2026-01-01");

SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*RIGHT JOIN*/
SELECT * FROM SUPERMERCADO;
SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT E RIGHT JOIN*/
SELECT *
FROM (
		SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL, 
        F.FUN_NOME AS NOME_FUNCIONARIO,
        P.PRO_NOME AS NOME_PRODUTO, 
        C.CON_NOME AS NOME_CONSUMIDOR
        FROM SUPERMERCADO S
        LEFT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P					ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 				ON(PC.FK_CON_CPF = C.CON_CPF)
        UNION
        SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL, 
        F.FUN_NOME AS NOME_FUNCIONARIO,
        P.PRO_NOME AS NOME_PRODUTO, 
        C.CON_NOME AS NOME_CONSUMIDOR
        FROM SUPERMERCADO S
        RIGHT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        RIGHT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        RIGHT JOIN PRODUTO 	P				ON (SP.FK_PRO_ID = P.PRO_ID)
        RIGHT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        RIGHT JOIN CONSUMIDOR C 			ON(PC.FK_CON_CPF = C.CON_CPF)
) SELECT_EXTERNO
ORDER BY 	SELECT_EXTERNO.RAZAO_SOCIAL ASC,
			SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
			SELECT_EXTERNO.NOME_PRODUTO ASC,
			SELECT_EXTERNO.NOME_CONSUMIDOR DESC;
/*EXERCÍCIO 1*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "NOME DO SUPERMERCADO",
		PRODUTO.PRO_NOME 				AS "NOME DO PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ )
INNER JOIN PRODUTO 		ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*EXERCÍCIO 2*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL",
		FUNCIONARIO.FUN_NOME 			AS "NOME DO FUNCIONARIO"
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*EXERCÍCIO 3*/
SELECT 	CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
		PRODUTO.PRO_NOME 	AS "NOME DO PRODUTO"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO 		ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR	ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO 4*/
SELECT 	PRODUTO.PRO_NOME 	AS "NOME DO PRODUTO",
		CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO 		ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR 	ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO 5*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL",
COUNT(*) AS "QUANTIDADE DE PRODUTOS"
FROM SUPERMERCADO_PRODUTO
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
INNER JOIN PRODUTO 		ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
GROUP BY SUPERMERCADO.SUP_RAZAO_SOCIAL;

/* EXERCÍCIO 1 - LEFT JOIN*/
SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO 	ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO 			ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*EXERCÍCIO 2*/
SELECT FUNCIONARIO.FUN_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/* EXERCÍCIO 3*/
SELECT CONSUMIDOR.CON_NOME, PRODUTO.PRO_NOME
FROM CONSUMIDOR
LEFT JOIN PRODUTO_CONSUMIDOR 	ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
LEFT JOIN PRODUTO 				ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID);

/* EXERCÍCIO 4*/
SELECT PRODUTO.PRO_NOME, CONSUMIDOR.CON_NOME
FROM PRODUTO
LEFT JOIN PRODUTO_CONSUMIDOR 	ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR 			ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF) ;

/* EXERCÍCIO 5 */
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL, FUNCIONARIO.FUN_NOME
FROM SUPERMERCADO
LEFT JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/* EXERCÍCIO 1 - RIGHT JOIN */
SELECT PRODUTO.PRO_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO 	ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO 			ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/* EXERCÍCIO 2*/
SELECT CONSUMIDOR.CON_NOME, PRODUTO.PRO_NOME
FROM CONSUMIDOR
RIGHT JOIN PRODUTO_CONSUMIDOR 	ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
RIGHT JOIN PRODUTO 				ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID);

/* EXERCÍCIO 3 */
SELECT FUNCIONARIO.FUN_NOME, SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/* EXERCÍCIO 4 */
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL, PRODUTO.PRO_NOME
FROM SUPERMERCADO
RIGHT JOIN SUPERMERCADO_PRODUTO 	ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO					ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID);

/* EXERCÍCIO 5 */
SELECT CONSUMIDOR.CON_NOME, PRODUTO.PRO_NOME
FROM CONSUMIDOR
RIGHT JOIN PRODUTO_CONSUMIDOR 	ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
RIGHT JOIN PRODUTO 				ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID);

/* SELECIONAR APENAS OS PRODUTOS QUE POSSUI APENAS REGISTRO EM UM SUPERMERCADO E QUE FORAM COMPRADOS POR UM CONSUMIDOR*/
SELECT 	P.PRO_NOME 			AS "NOME DO PRODUTO",
		P.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		P.PRO_PRECO 		AS "PREÇO DO PRODUTO"
FROM 	PRODUTO P
WHERE 	P.PRO_ID IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND 	P.PRO_ID IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/* SELCIONAR APENAS OS PRODUTOS QUE NÃO POSSUEM REGISTRO EM UM SUPERMERCADO E QUE NÃO FORAM COMPRADOS POR UM CONSUMIDOR */
SELECT 	P.PRO_NOME 			AS "NOME DO PRODUTO",
		P.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		P.PRO_PRECO 		AS "PREÇO DO PRODUTO"
FROM 	PRODUTO P
WHERE 	P.PRO_ID NOT IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND 	P.PRO_ID NOT IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/* SELECIONAR OS SUPERMERCADOS QUE TEM O PREÇO DE TODOS OS PRODUTOS MENOR QUE 10*/
SELECT S.SUP_RAZAO_SOCIAL
FROM SUPERMERCADO S
WHERE 10 > ALL (
	SELECT P.PRO_PRECO
    FROM PRODUTO P
);

/* LISTAR TODOS OS PRODUTOS CUJO O PREÇO SEJA MAIOR QUE O PREÇO DE QUALQUER PRODUTO VENDIDO NO SUPERMERCADO COM CNPJ 12345678910*/
SELECT PRO_NOME, PRO_PRECO
FROM PRODUTO
WHERE PRO_PRECO > ANY (
	SELECT P.PRO_PRECO
    FROM PRODUTO P 
    INNER  JOIN SUPERMERCADO_PRODUTO SP 
    ON (P.PRO_ID = SP.FK_PRO_ID)
    WHERE SP.FK_SUP_CNPJ = "12345678910"
);

/* LISTAR TODOS CONSUMIDORES QUE COMPRARAM PELO MENOS UM PRODUTO */
SELECT 	C.CON_NOME, C.CON_CPF
FROM 	CONSUMIDOR C
WHERE EXISTS (
	SELECT 1
    FROM PRODUTO_CONSUMIDOR PC
    WHERE PC.FK_CON_CPF = C.CON_CPF
);

/* LISTAR TODOS CONSUMIDORES QUE NÃO COMPRARAM NENHUM PRODUTO */
SELECT 	C.CON_NOME, C.CON_CPF
FROM 	CONSUMIDOR C
WHERE  NOT EXISTS (
	SELECT 1
    FROM PRODUTO_CONSUMIDOR PC
    WHERE PC.FK_CON_CPF = C.CON_CPF
);

/* TCL LINGUAGEM DE CONTROLE DE TRANSAÇÕES: COMMIT */
-- PASSO 1: INICIAR A TRANSAÇÃO 
START TRANSACTION;

-- PASSO 2: ESCRECER O COMANDO DML
INSERT INTO SUPERMERCADO (	SUP_CNPJ, 
							SUP_RAZAO_SOCIAL, 
                            SUP_TELEFONE, 
                            SUP_EMAIL, 
                            SUP_ENDERECO_LOGRADOURO, 
                            SUP_ENDERECO_NUMERO, 
                            SUP_ENDERECO_CIDADE, 
                            SUP_ENDERECO_ESTADO)
VALUES ("111111222000111", "Supermercado Pontes", "19998034808","pontes@pontes.com", "Rua do Pontes", "100", "Tambaú", "SP");

-- PASSO 3: SE TUDO DEU CERTO, EXIBA PRO BANCO
COMMIT;

/* TCL LINGUAGEM DE CONTROLE DE TRANSAÇÕES: COMMIT */
-- PASSO 1: INICIAR A TRANSAÇÃO 
START TRANSACTION;

-- PASSO 2: ESCRECER O COMANDO DML
INSERT INTO SUPERMERCADO (	SUP_CNPJ, 
							SUP_RAZAO_SOCIAL, 
                            SUP_TELEFONE, 
                            SUP_EMAIL, 
                            SUP_ENDERECO_LOGRADOURO, 
                            SUP_ENDERECO_NUMERO, 
                            SUP_ENDERECO_CIDADE, 
                            SUP_ENDERECO_ESTADO)
VALUES ("111111222000111", "Supermercado Pontes", "19998034808","pontes@pontes.com", "Rua do Pontes", "100", "Tambaú", "SP");

-- PASSO 3: SE TUDO DEU CERTO, EXIBA PRO BANCO
ROLLBACK;

START TRANSACTION;

-- INSERIR NOVO SUP
INSERT INTO SUPERMERCADO (	SUP_CNPJ, 
							SUP_RAZAO_SOCIAL, 
                            SUP_TELEFONE, 
                            SUP_EMAIL, 
                            SUP_ENDERECO_LOGRADOURO, 
                            SUP_ENDERECO_NUMERO, 
                            SUP_ENDERECO_CIDADE, 
                            SUP_ENDERECO_ESTADO)
VALUES ("3333333330001", "Supermercado Nova Era", "11987654321","contato@novaera.com", "Rua Nova", "150", "Porto Alegre", "RS");

-- Criar um ponto de salvamento
SAVEPOINT savepoint_produto1;

-- Inserir o primeiro produto
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("1234567890987", "Açúcar 1Kg", "1.0", 200, 3.00, "2025-06-30");

-- Criarum segundo ponto de salvamento 
SAVEPOINT savepoint_produto2;

-- Inserir o segundo produto com dado invalido
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("9876543210123", "Café 500g", "500", -100, 15.00, "2025-09-30"); -- quantidade negativa (erro)

-- Se ocorrer um erro, reverter apenas até o segundo savepoint
ROLLBACK TO savepoint_produto2;

-- Confirmar as mudanças até o primeiro savepoint
COMMIT; 